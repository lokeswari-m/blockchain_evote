<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="Cast your vote securely with blockchain verification. Each vote is cryptographically sealed and tamper-proof.">
    <title>Cast Your Vote ‚Äî BlockVote</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üó≥Ô∏è</text></svg>">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
</head>

<body>

    <!-- Floating particles -->
    <div class="particles-container" id="particles"></div>

    <!-- ‚ïê‚ïê‚ïê Navigation ‚ïê‚ïê‚ïê -->
    <nav class="navbar">
        <a href="/" class="navbar-brand">
            <div class="brand-icon"><i data-lucide="vote" stroke-width="2.5"></i></div>
            <span>BlockVote</span>
        </a>
        <ul class="navbar-links">
            <li><a href="/"><i data-lucide="home"></i> <span>Home</span></a></li>
            <li><a href="/admin"><i data-lucide="shield"></i> <span>Admin</span></a></li>
            <li><a href="/voter" class="active"><i data-lucide="check-square"></i> <span>Vote Now</span></a></li>
        </ul>
    </nav>

    <div class="voter-container">

        <!-- ‚ïê‚ïê‚ïê Step 1: Login ‚ïê‚ïê‚ïê -->
        <div id="step-login">
            <div class="voter-header">
                <h1><span class="gradient-text">Cast Your Vote</span></h1>
                <p>Enter your voter ID to begin the secure voting process</p>
            </div>

            <div class="glass-card login-card">
                <div id="login-alert"></div>
                <form id="voter-login-form">
                    <div class="form-group">
                        <label class="form-label" for="voter-id">
                            <i data-lucide="hash"></i> Voter ID
                        </label>
                        <input type="text" id="voter-id" class="form-control" placeholder="e.g. V001" required
                            autofocus>
                    </div>
                    <button type="submit" class="btn btn-primary btn-block" id="login-btn">
                        <i data-lucide="fingerprint"></i> Verify Identity
                    </button>
                </form>
                <p class="text-muted text-center" style="font-size:0.78rem; margin-top:16px;">
                    Your voter ID was provided during registration
                </p>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê Step 2: Select Candidate ‚ïê‚ïê‚ïê -->
        <div id="step-vote" style="display:none;">
            <div class="voter-header">
                <h1>Select Your Candidate</h1>
                <p>Welcome, <strong id="voter-name-display"></strong>. Choose one candidate below.</p>
            </div>

            <div id="vote-alert"></div>

            <div class="candidate-grid" id="candidate-list"></div>

            <div class="text-center" style="margin-top:28px;">
                <button class="btn btn-primary btn-lg" id="submit-vote-btn" disabled>
                    <i data-lucide="check-square"></i> Submit Vote
                </button>
                <p class="text-muted" style="font-size:0.78rem; margin-top:10px;">
                    <i data-lucide="lock" style="width:12px;height:12px;display:inline;vertical-align:-2px;"></i>
                    Your vote will be permanently recorded on the blockchain
                </p>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê Step 3: Confirmation Modal ‚ïê‚ïê‚ïê -->
        <div class="modal-overlay" id="confirm-modal">
            <div class="modal">
                <div class="modal-icon">
                    <i data-lucide="alert-triangle"></i>
                </div>
                <h3>Confirm Your Vote</h3>
                <p>You are about to vote for <strong id="confirm-candidate-name"></strong>. This action is permanent and
                    cannot be undone. Your vote will be mined into the blockchain.</p>
                <div class="modal-actions">
                    <button class="btn btn-secondary" id="cancel-vote-btn">
                        <i data-lucide="x"></i> Cancel
                    </button>
                    <button class="btn btn-primary" id="confirm-vote-btn">
                        <i data-lucide="check"></i> Confirm Vote
                    </button>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê Step 4: Receipt ‚ïê‚ïê‚ïê -->
        <div id="step-receipt" style="display:none;">
            <div class="glass-card receipt-card">
                <div class="receipt-icon success">
                    <i data-lucide="check-circle"></i>
                </div>
                <h2 class="success">Vote Recorded Successfully!</h2>
                <p class="text-muted" style="font-size:0.9rem;">Your vote has been mined into the blockchain</p>

                <div class="hash-display" id="receipt-hash"></div>

                <div class="receipt-details">
                    <div class="detail-row">
                        <span class="d-label">Voter ID</span>
                        <span class="d-value" id="receipt-voter-id"></span>
                    </div>
                    <div class="detail-row">
                        <span class="d-label">Candidate</span>
                        <span class="d-value" id="receipt-candidate"></span>
                    </div>
                    <div class="detail-row">
                        <span class="d-label">Block Index</span>
                        <span class="d-value" id="receipt-block-index"></span>
                    </div>
                    <div class="detail-row">
                        <span class="d-label">Timestamp</span>
                        <span class="d-value" id="receipt-timestamp"></span>
                    </div>
                    <div class="detail-row">
                        <span class="d-label">Chain Status</span>
                        <span class="d-value">
                            <span class="badge badge-success">
                                <i data-lucide="shield-check"></i> Verified
                            </span>
                        </span>
                    </div>
                </div>

                <a href="/" class="btn btn-secondary btn-block" style="margin-top:8px;">
                    <i data-lucide="arrow-left"></i> Back to Home
                </a>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê Already Voted Screen ‚ïê‚ïê‚ïê -->
        <div id="step-already-voted" style="display:none;">
            <div class="glass-card receipt-card">
                <div class="receipt-icon warning">
                    <i data-lucide="alert-circle"></i>
                </div>
                <h2 class="warning">Already Voted</h2>
                <p class="text-muted" style="font-size:0.9rem;">You have already cast your vote in this election.</p>

                <div id="existing-vote-info" class="receipt-details" style="margin-top:20px;"></div>

                <a href="/" class="btn btn-secondary btn-block" style="margin-top:8px;">
                    <i data-lucide="arrow-left"></i> Back to Home
                </a>
            </div>
        </div>

    </div>

    <!-- Footer -->
    <footer class="footer">
        <p>BlockVote ‚Äî Every vote is blockchain-verified &nbsp;¬∑&nbsp; Built with Python, Flask &amp; Blockchain</p>
    </footer>

    <script src="{{ url_for('static', filename='js/voter.js') }}"></script>
    <script>
        lucide.createIcons();

        // Floating particles
        (function () {
            const c = document.getElementById('particles');
            const colors = ['rgba(99,102,241,0.25)', 'rgba(139,92,246,0.2)', 'rgba(6,182,212,0.15)'];
            for (let i = 0; i < 25; i++) {
                const p = document.createElement('div');
                p.className = 'particle';
                const size = 2 + Math.random() * 4;
                p.style.cssText = `
                    left: ${Math.random() * 100}%;
                    width: ${size}px; height: ${size}px;
                    background: ${colors[Math.floor(Math.random() * colors.length)]};
                    animation-duration: ${10 + Math.random() * 15}s;
                    animation-delay: ${Math.random() * 12}s;
                `;
                c.appendChild(p);
            }
        })();
    </script>
</body>

</html>